
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Test Gardening Report Week 7-8 - TecendoBits/WeavingBits Blog</title>
  <meta name="author" content="gabithume">

  
  <meta name="description" content="This is a short post about my seven and eight weeks contributing for Socorro. It is brief because I had problems with my etherpad-diary and I lost &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tecendobits.cc/blog/test-gardening-report-week-7-8">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/blog/atom.xml" rel="alternate" title="TecendoBits/WeavingBits Blog" type="application/atom+xml">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href= "http://fonts.googleapis.com/css?family=Gochi+Hand:regular,italic,bold,bolditalic" rel='stylesheet' type='text/css'>
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel='stylesheet' type='text/css'>


  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">TecendoBits/WeavingBits Blog</a></h1>
  
    <h2>A place to random thoughts.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tecendobits.cc/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/../">TecendoBits Page</a></li>
  <li><a href="/blog/../about.html">About</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Test Gardening Report Week 7-8</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-11T12:52:00-03:00" pubdate data-updated="true">Aug 11<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>This is a short post about my seven and eight weeks contributing for Socorro. It is brief because I had problems with my etherpad-diary and I lost some of the comments, so I wrote here my code contributions during this time.</p>

<hr />

<h3>Automatic elastic search tests</h3>

<p>Thanks to @adrian I made the integration test <code>test_elasticsearch_storage_app.py</code> be automatic and I closed the <a href = https://bugzilla.mozilla.org/show_bug.cgi?id=892672>Bug 892672</a>. The Pull Request related was the <a href=https://github.com/mozilla/socorro/pull/1383>1383</a>. Basically, what I did was to call the test code inside a shell script that Jenkins runs. To make elastic search test works, I configured the host to be <code>jenkins-es20</code> and setted up the environment before to call the test itself.</p>

<!-- more -->


<hr />

<h3>Database tests</h3>

<p>How to test code that uses database?</p>

<p>By first, when dealing with database values we need to populate tables we are going to use in <code>setUp</code> function. This function runs before any test, so it is the best place for doing this.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span class='line'><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
</span><span class='line'><span class="s">    INSERT INTO products</span>
</span><span class='line'><span class="s">    (product_name, sort, rapid_release_version, release_name)</span>
</span><span class='line'><span class="s">    VALUES</span>
</span><span class='line'><span class="s">    (&#39;Firefox&#39;, 1, &#39;8.0&#39;, &#39;firefox&#39;),</span>
</span><span class='line'><span class="s">    (&#39;Fennec&#39;, 2, &#39;11.0&#39;, &#39;mobile&#39;);</span>
</span><span class='line'><span class="s">&quot;&quot;&quot;</span><span class="p">)</span>
</span><span class='line'><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>After populate the tables with some fake data, we can manipulate the data to test what we want. For example: we have a product name, its version and a date for which we want to know what is the latest entry related to that product before the date we provided. In following case, given the today date, the latest entry was seven days ago:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">test_latestEntryBeforeOrEqualTo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">product</span> <span class="o">=</span> <span class="s">&#39;Firefox&#39;</span>
</span><span class='line'>    <span class="n">version</span> <span class="o">=</span> <span class="s">&#39;8.0&#39;</span>
</span><span class='line'>    <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
</span><span class='line'>    <span class="n">to_date</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="n">lastweek</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">res</span> <span class="o">=</span> <span class="n">tcbs</span><span class="o">.</span><span class="n">latestEntryBeforeOrEqualTo</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">to_date</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>
</span><span class='line'>    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">lastweek</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>And at end of test, the<code>tearDown</code> method can be used to drop the tables, cleaning the database:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Cleanup the database, delete tables and functions &quot;&quot;&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span class='line'>    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
</span><span class='line'><span class="s">        TRUNCATE tcbs, products, signatures</span>
</span><span class='line'><span class="s">        CASCADE;</span>
</span><span class='line'><span class="s">    &quot;&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">super</span><span class="p">(</span><span class="n">IntegrationTestTCBS</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">tearDown</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Knowing that, it is really interesting to develop tests for functions that manipulate databases. The <a href=https://github.com/mozilla/socorro/pull/1396>Pull Request 1396</a> and <a href=https://bugzilla.mozilla.org/show_bug.cgi?id=904243>Bug 904243</a> are related to a test of TopCrashers by Signature (TCBS).</p>

<hr />

<h3>Submitter App Test</h3>

<p>Related to <a href=https://bugzilla.mozilla.org/show_bug.cgi?id=820512>Bug 820512</a> and my <a href=https://github.com/mozilla/socorro/pull/1368>Pull Request 1368</a>, @lars solved the problem I had by asking me to insert <code>force=True</code> on required configuration for the context of <code>socorro/processor/processor_app.py</code>. Merged :)</p>

<hr />

<h3>Test Documentation</h3>

<p>Some instructions on socorro installation weren&#8217;t working anymore, so I updated it at <a href=https://github.com/mozilla/socorro/pull/1381>Pull Request 1381</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">gabithume</span></span>

      








  


<time datetime="2013-08-11T12:52:00-03:00" pubdate data-updated="true">Aug 11<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/blog/categories/bug/'>bug</a>, <a class='category' href='/blog/blog/categories/code/'>code</a>, <a class='category' href='/blog/blog/categories/documentation/'>documentation</a>, <a class='category' href='/blog/blog/categories/gnome/'>gnome</a>, <a class='category' href='/blog/blog/categories/mozilla/'>mozilla</a>, <a class='category' href='/blog/blog/categories/opw/'>opw</a>, <a class='category' href='/blog/blog/categories/socorro/'>socorro</a>, <a class='category' href='/blog/blog/categories/test/'>test</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://tecendobits.cc/blog/test-gardening-report-week-7-8/" data-via="gabithume" data-counturl="http://tecendobits.cc/blog/test-gardening-report-week-7-8/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/test-gardening-report-week-4-5/" title="Previous Post: Test Gardening Report Week 5-6">&laquo; Test Gardening Report Week 5-6</a>
      
      
        <a class="basic-alignment right" href="/blog/test-gardening-report-week-9-10/" title="Next Post: Test Gardening Report Week 9-10">Test Gardening Report Week 9-10 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section id="social">
<a href="https://github.com/GabiThume/">
    <div class="social-link">
          <img src="/blog/images/icons/github.png" width="32" height="32">
</div>
</a>

    <a href="http://www.linkedin.com/in/gabithume">
<div class="social-link">
      <img src="/blog/images/icons/linkedin.png" width="32" height="32">
</div>
    </a>

    <a href="https://www.facebook.com/gabithume">
<div class="social-link">
      <img src="/blog/images/icons/facebook.png" width="32" height="32">
</div>
    </a>


<div class="social-link">
    <a href="http://tecendobits.tumblr.com/">
      <img src="/blog/images/icons/tumblr.png" width="32" height="32">
    </a>
</div>

<div class="social-link">
    <a href="http://vimeo.com/gabithume">
      <img src="/blog/images/icons/vimeo.png" width="32" height="32">
    </a>
</div>

<a href="mailto:gabithume@gmail.com">
    <div class="social-link">
          <img src="/blog/images/icons/email.png" width="32" height="32">
</div>
</a>

<div class="social-link">
    <a href="atom.xml">
      <img src="/blog/images/icons/rss.png" width="32" height="32">
    </a>
</div>

    <a href="https://plus.google.com/115961070759198455564/posts">
<div class="social-link">
      <img src="/blog/images/icons/gplus2.png" width="32" height="32">
</div>
    </a>

    <a href="https://twitter.com/gabithume">
<div class="social-link">
      <img src="/blog/images/icons/twitter.png" width="32" height="32">
</div>
    </a>

<div class="social-link">
    <a href="http://instagram.com/gabithume#">
      <img src="/blog/images/icons/instagram.png" width="32" height="32">
    </a>
</div>


<div class="social-link">
    <a href="http://pinterest.com/gabithume/following/">
      <img src="/blog/images/icons/pinterest.png" width="32" height="32">
    </a>
</div>


<div class="social-link">
    <a href="https://delicious.com/gabithume">
      <img src="/blog/images/icons/delicious.png" width="32" height="32">
    </a>
</div>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/test-gardening-report-week-11-12/">Test Gardening Report Week 11-12</a>
      </li>
    
      <li class="post">
        <a href="/blog/manual-testing/">Manual Testing</a>
      </li>
    
      <li class="post">
        <a href="/blog/test-gardening-report-week-9-10/">Test Gardening Report Week 9-10</a>
      </li>
    
      <li class="post">
        <a href="/blog/test-gardening-report-week-7-8/">Test Gardening Report Week 7-8</a>
      </li>
    
      <li class="post">
        <a href="/blog/test-gardening-report-week-4-5/">Test Gardening Report Week 5-6</a>
      </li>
    
      <li class="post">
        <a href="/blog/test-gardening/">Test Gardening Report Week 3-4</a>
      </li>
    
      <li class="post">
        <a href="/blog/first-weeks-of-opw/">Test Gardening Report Week 1-2</a>
      </li>
    
      <li class="post">
        <a href="/blog/mozilla-socorro-project/">Socorro Project</a>
      </li>
    
      <li class="post">
        <a href="/blog/opw-application-for-mozilla/">OPW Application for Mozilla</a>
      </li>
    
      <li class="post">
        <a href="/blog/winter-of-code/">Winter of code</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/GabiThume">@GabiThume</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'GabiThume',
            count: 10,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/gabithume?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/gabithume">My Delicious Bookmarks &raquo;</a></p>
</section>
<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/blogblog/categories/bdd' style='font-size: 106.0%'>bdd</a> <a href='/blog/blogblog/categories/bug' style='font-size: 130.0%'>bug</a> <a href='/blog/blogblog/categories/code' style='font-size: 160.0%'>code</a> <a href='/blog/blogblog/categories/crash-stats' style='font-size: 118.0%'>crash stats</a> <a href='/blog/blogblog/categories/crash-stats' style='font-size: 106.0%'>crash-stats</a> <a href='/blog/blogblog/categories/documentation' style='font-size: 124.0%'>documentation</a> <a href='/blog/blogblog/categories/gnome' style='font-size: 154.0%'>gnome</a> <a href='/blog/blogblog/categories/mozilla' style='font-size: 154.0%'>mozilla</a> <a href='/blog/blogblog/categories/opw' style='font-size: 106.0%'>OPW</a> <a href='/blog/blogblog/categories/opw' style='font-size: 154.0%'>opw</a> <a href='/blog/blogblog/categories/socorro' style='font-size: 160.0%'>socorro</a> <a href='/blog/blogblog/categories/test' style='font-size: 148.0%'>test</a> </span>
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Gabriela Thum&eacute; - TecendoBits <span class="credit"> - Using <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'tecendobits';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://tecendobits.cc/blog/test-gardening-report-week-7-8/';
        var disqus_url = 'http://tecendobits.cc/blog/test-gardening-report-week-7-8/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
